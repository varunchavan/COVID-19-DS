{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>state</th>\n",
       "      <th>country</th>\n",
       "      <th>confirmed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Korea, South</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Kosovo</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Kuwait</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Kyrgyzstan</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        date    state       country  confirmed\n",
       "0 2020-01-22  Alberta        Canada        0.0\n",
       "1 2020-01-22       no  Korea, South        1.0\n",
       "2 2020-01-22       no        Kosovo        0.0\n",
       "3 2020-01-22       no        Kuwait        0.0\n",
       "4 2020-01-22       no    Kyrgyzstan        0.0"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import subprocess,os\n",
    "import pandas as pd\n",
    "import requests,json\n",
    "import numpy as np\n",
    "\n",
    "\n",
    "\n",
    "pd_JH_data=pd.read_csv('../data/processed/COVID_relational_confirmed.csv',sep=';',parse_dates=[0])\n",
    "pd_JH_data=pd_JH_data.sort_values('date',ascending=True).reset_index(drop=True).copy()\n",
    "pd_JH_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "test_data=pd_JH_data[((pd_JH_data['country']=='US')|\n",
    "                     (pd_JH_data['country']=='Germany'))&\n",
    "                     (pd_JH_data['date']>'2020-03-20')]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>state</th>\n",
       "      <th>country</th>\n",
       "      <th>confirmed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>15736</th>\n",
       "      <td>2020-03-21</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>22213.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15776</th>\n",
       "      <td>2020-03-21</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>24508.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16003</th>\n",
       "      <td>2020-03-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>24873.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16043</th>\n",
       "      <td>2020-03-22</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>33152.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16267</th>\n",
       "      <td>2020-03-23</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>29056.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16307</th>\n",
       "      <td>2020-03-23</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>43850.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16534</th>\n",
       "      <td>2020-03-24</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>32986.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16575</th>\n",
       "      <td>2020-03-24</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>54112.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16800</th>\n",
       "      <td>2020-03-25</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>37323.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16855</th>\n",
       "      <td>2020-03-25</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>66055.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17066</th>\n",
       "      <td>2020-03-26</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>43938.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17106</th>\n",
       "      <td>2020-03-26</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>83611.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17333</th>\n",
       "      <td>2020-03-27</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>50871.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17373</th>\n",
       "      <td>2020-03-27</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>102101.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17599</th>\n",
       "      <td>2020-03-28</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>57695.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17638</th>\n",
       "      <td>2020-03-28</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>122059.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17864</th>\n",
       "      <td>2020-03-29</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>62095.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17919</th>\n",
       "      <td>2020-03-29</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>141205.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18131</th>\n",
       "      <td>2020-03-30</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>66885.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18172</th>\n",
       "      <td>2020-03-30</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>162707.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18396</th>\n",
       "      <td>2020-03-31</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>71808.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18437</th>\n",
       "      <td>2020-03-31</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>188744.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18661</th>\n",
       "      <td>2020-04-01</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>77872.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18717</th>\n",
       "      <td>2020-04-01</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>214205.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18929</th>\n",
       "      <td>2020-04-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>84794.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18969</th>\n",
       "      <td>2020-04-02</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>244610.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19193</th>\n",
       "      <td>2020-04-03</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>91159.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19233</th>\n",
       "      <td>2020-04-03</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>276547.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19460</th>\n",
       "      <td>2020-04-04</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>96092.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19515</th>\n",
       "      <td>2020-04-04</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>309699.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55903</th>\n",
       "      <td>2020-08-19</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>229706.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55943</th>\n",
       "      <td>2020-08-19</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5529824.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56168</th>\n",
       "      <td>2020-08-20</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>231292.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56208</th>\n",
       "      <td>2020-08-20</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5573847.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56435</th>\n",
       "      <td>2020-08-21</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>233029.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56475</th>\n",
       "      <td>2020-08-21</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5622470.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56701</th>\n",
       "      <td>2020-08-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>233861.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56741</th>\n",
       "      <td>2020-08-22</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5667070.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56967</th>\n",
       "      <td>2020-08-23</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>234494.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57006</th>\n",
       "      <td>2020-08-23</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5701645.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57233</th>\n",
       "      <td>2020-08-24</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>236122.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57273</th>\n",
       "      <td>2020-08-24</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5739536.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57499</th>\n",
       "      <td>2020-08-25</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>237583.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57539</th>\n",
       "      <td>2020-08-25</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5777710.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57765</th>\n",
       "      <td>2020-08-26</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>239010.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57805</th>\n",
       "      <td>2020-08-26</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5821819.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58030</th>\n",
       "      <td>2020-08-27</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>240571.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58085</th>\n",
       "      <td>2020-08-27</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5867785.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58297</th>\n",
       "      <td>2020-08-28</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>242126.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58337</th>\n",
       "      <td>2020-08-28</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5913941.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58561</th>\n",
       "      <td>2020-08-29</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>242835.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58601</th>\n",
       "      <td>2020-08-29</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5961094.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58829</th>\n",
       "      <td>2020-08-30</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>243305.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58870</th>\n",
       "      <td>2020-08-30</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5996431.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59093</th>\n",
       "      <td>2020-08-31</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>244802.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59133</th>\n",
       "      <td>2020-08-31</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>6030587.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59361</th>\n",
       "      <td>2020-09-01</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>246015.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59402</th>\n",
       "      <td>2020-09-01</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>6073840.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59626</th>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>247411.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59668</th>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>6113510.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>332 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            date state  country  confirmed\n",
       "15736 2020-03-21    no  Germany    22213.0\n",
       "15776 2020-03-21    no       US    24508.0\n",
       "16003 2020-03-22    no  Germany    24873.0\n",
       "16043 2020-03-22    no       US    33152.0\n",
       "16267 2020-03-23    no  Germany    29056.0\n",
       "16307 2020-03-23    no       US    43850.0\n",
       "16534 2020-03-24    no  Germany    32986.0\n",
       "16575 2020-03-24    no       US    54112.0\n",
       "16800 2020-03-25    no  Germany    37323.0\n",
       "16855 2020-03-25    no       US    66055.0\n",
       "17066 2020-03-26    no  Germany    43938.0\n",
       "17106 2020-03-26    no       US    83611.0\n",
       "17333 2020-03-27    no  Germany    50871.0\n",
       "17373 2020-03-27    no       US   102101.0\n",
       "17599 2020-03-28    no  Germany    57695.0\n",
       "17638 2020-03-28    no       US   122059.0\n",
       "17864 2020-03-29    no  Germany    62095.0\n",
       "17919 2020-03-29    no       US   141205.0\n",
       "18131 2020-03-30    no  Germany    66885.0\n",
       "18172 2020-03-30    no       US   162707.0\n",
       "18396 2020-03-31    no  Germany    71808.0\n",
       "18437 2020-03-31    no       US   188744.0\n",
       "18661 2020-04-01    no  Germany    77872.0\n",
       "18717 2020-04-01    no       US   214205.0\n",
       "18929 2020-04-02    no  Germany    84794.0\n",
       "18969 2020-04-02    no       US   244610.0\n",
       "19193 2020-04-03    no  Germany    91159.0\n",
       "19233 2020-04-03    no       US   276547.0\n",
       "19460 2020-04-04    no  Germany    96092.0\n",
       "19515 2020-04-04    no       US   309699.0\n",
       "...          ...   ...      ...        ...\n",
       "55903 2020-08-19    no  Germany   229706.0\n",
       "55943 2020-08-19    no       US  5529824.0\n",
       "56168 2020-08-20    no  Germany   231292.0\n",
       "56208 2020-08-20    no       US  5573847.0\n",
       "56435 2020-08-21    no  Germany   233029.0\n",
       "56475 2020-08-21    no       US  5622470.0\n",
       "56701 2020-08-22    no  Germany   233861.0\n",
       "56741 2020-08-22    no       US  5667070.0\n",
       "56967 2020-08-23    no  Germany   234494.0\n",
       "57006 2020-08-23    no       US  5701645.0\n",
       "57233 2020-08-24    no  Germany   236122.0\n",
       "57273 2020-08-24    no       US  5739536.0\n",
       "57499 2020-08-25    no  Germany   237583.0\n",
       "57539 2020-08-25    no       US  5777710.0\n",
       "57765 2020-08-26    no  Germany   239010.0\n",
       "57805 2020-08-26    no       US  5821819.0\n",
       "58030 2020-08-27    no  Germany   240571.0\n",
       "58085 2020-08-27    no       US  5867785.0\n",
       "58297 2020-08-28    no  Germany   242126.0\n",
       "58337 2020-08-28    no       US  5913941.0\n",
       "58561 2020-08-29    no  Germany   242835.0\n",
       "58601 2020-08-29    no       US  5961094.0\n",
       "58829 2020-08-30    no  Germany   243305.0\n",
       "58870 2020-08-30    no       US  5996431.0\n",
       "59093 2020-08-31    no  Germany   244802.0\n",
       "59133 2020-08-31    no       US  6030587.0\n",
       "59361 2020-09-01    no  Germany   246015.0\n",
       "59402 2020-09-01    no       US  6073840.0\n",
       "59626 2020-09-02    no  Germany   247411.0\n",
       "59668 2020-09-02    no       US  6113510.0\n",
       "\n",
       "[332 rows x 4 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>state</th>\n",
       "      <th>confirmed</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>country</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Germany</th>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>247411.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>US</th>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>6113510.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              date state  confirmed\n",
       "country                            \n",
       "Germany 2020-09-02    no   247411.0\n",
       "US      2020-09-02    no  6113510.0"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_data.groupby(['country']).agg(np.max)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "# %load ../src/features/build_features.py\n",
    "import subprocess,os\n",
    "import pandas as pd\n",
    "import requests,json\n",
    "import numpy as np\n",
    "from sklearn import linear_model\n",
    "\n",
    "reg= linear_model.LinearRegression(fit_intercept=True)\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "def get_doubling_time_via_regression(in_array):\n",
    "    ''' Use a linear regression to approximate the doubling rate'''\n",
    "    #print(in_array)    \n",
    "    \n",
    "    #y=np.array(in_array)\n",
    "    #x=np.arange(-1,2).reshape(-1,1)\n",
    "    \n",
    "    y=np.array(in_array)\n",
    "    x=np.arange(len(y)).reshape(-1,1)\n",
    "    \n",
    "    assert len(in_array==3)\n",
    "    reg.fit(x,y)\n",
    "    intercept=reg.intercept_\n",
    "    slope=reg.coef_\n",
    "    \n",
    "    return intercept/slope\n",
    "\n",
    "#if __name__== '__main__':\n",
    "#    test_data=np.array([2,4,6])\n",
    "#    result=get_doubling_time_via_regression(test_data)\n",
    "#    print('the test slope is: '+str(result))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>confirmed</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>state</th>\n",
       "      <th>country</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">no</th>\n",
       "      <th>Germany</th>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>247411.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>US</th>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>6113510.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    date  confirmed\n",
       "state country                      \n",
       "no    Germany 2020-09-02   247411.0\n",
       "      US      2020-09-02  6113510.0"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_data.groupby(['state','country']).agg(np.max)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "#test_data.groupby(['state','country']).apply(get_doubling_time_via_regression)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "def rolling_reg(df_input,col='confirmed'):\n",
    "    \n",
    "    '''input has to be a data frame'''\n",
    "    '''return is single series (mandatory for group by apply)'''\n",
    "\n",
    "    days_back=3\n",
    "    result=df_input[col].rolling(\n",
    "                window=days_back,\n",
    "                min_periods=days_back).apply(get_doubling_time_via_regression,raw=False)\n",
    "\n",
    "    return result\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "state  country       \n",
       "no     Germany  15736           NaN\n",
       "                16003           NaN\n",
       "                16267      6.417994\n",
       "                16534      6.142035\n",
       "                16800      7.012983\n",
       "                17066      5.954407\n",
       "                17333      5.501919\n",
       "                17599      6.390371\n",
       "                17864      9.136671\n",
       "                18131     12.541893\n",
       "                18396     12.781393\n",
       "                18661     12.140681\n",
       "                18929     11.037271\n",
       "                19193     11.735506\n",
       "                19460     15.052694\n",
       "                19726     20.372453\n",
       "                19991     26.427355\n",
       "                20259     26.511936\n",
       "                20524     20.792179\n",
       "                20790     20.495848\n",
       "                21057     25.565108\n",
       "                21323     35.198404\n",
       "                21589     42.982990\n",
       "                21855     48.423444\n",
       "                22121     73.043747\n",
       "                22387     55.424411\n",
       "                22653     41.468318\n",
       "                22918     40.525988\n",
       "                23185     48.898063\n",
       "                23450     74.684007\n",
       "                            ...    \n",
       "       US       51953     90.685726\n",
       "                52219     85.443196\n",
       "                52484     84.797301\n",
       "                52751     81.858790\n",
       "                53017     85.422707\n",
       "                53282     95.884837\n",
       "                53549    103.606172\n",
       "                53814    104.735503\n",
       "                54081     98.879424\n",
       "                54346     95.442858\n",
       "                54613     89.696852\n",
       "                54879     93.607140\n",
       "                55144    118.145185\n",
       "                55411    138.992250\n",
       "                55677    134.744110\n",
       "                55943    118.866789\n",
       "                56208    121.243661\n",
       "                56475    119.358792\n",
       "                56741    119.595325\n",
       "                57006    142.068603\n",
       "                57273    156.391062\n",
       "                57539    149.913832\n",
       "                57805    139.483170\n",
       "                58085    128.279778\n",
       "                58337    126.392986\n",
       "                58601    125.767479\n",
       "                58870    143.433394\n",
       "                59133    171.565218\n",
       "                59402    154.889350\n",
       "                59668    145.464688\n",
       "Name: confirmed, Length: 332, dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_data[['state','country','confirmed']].groupby(['state','country']\n",
    "                                                  ).apply(rolling_reg,'confirmed')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>state</th>\n",
       "      <th>country</th>\n",
       "      <th>confirmed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>15736</th>\n",
       "      <td>2020-03-21</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>22213.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15776</th>\n",
       "      <td>2020-03-21</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>24508.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16003</th>\n",
       "      <td>2020-03-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>24873.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16043</th>\n",
       "      <td>2020-03-22</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>33152.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16267</th>\n",
       "      <td>2020-03-23</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>29056.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16307</th>\n",
       "      <td>2020-03-23</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>43850.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16534</th>\n",
       "      <td>2020-03-24</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>32986.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16575</th>\n",
       "      <td>2020-03-24</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>54112.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16800</th>\n",
       "      <td>2020-03-25</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>37323.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16855</th>\n",
       "      <td>2020-03-25</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>66055.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17066</th>\n",
       "      <td>2020-03-26</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>43938.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17106</th>\n",
       "      <td>2020-03-26</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>83611.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17333</th>\n",
       "      <td>2020-03-27</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>50871.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17373</th>\n",
       "      <td>2020-03-27</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>102101.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17599</th>\n",
       "      <td>2020-03-28</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>57695.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17638</th>\n",
       "      <td>2020-03-28</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>122059.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17864</th>\n",
       "      <td>2020-03-29</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>62095.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17919</th>\n",
       "      <td>2020-03-29</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>141205.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18131</th>\n",
       "      <td>2020-03-30</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>66885.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18172</th>\n",
       "      <td>2020-03-30</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>162707.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18396</th>\n",
       "      <td>2020-03-31</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>71808.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18437</th>\n",
       "      <td>2020-03-31</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>188744.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18661</th>\n",
       "      <td>2020-04-01</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>77872.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18717</th>\n",
       "      <td>2020-04-01</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>214205.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18929</th>\n",
       "      <td>2020-04-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>84794.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18969</th>\n",
       "      <td>2020-04-02</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>244610.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19193</th>\n",
       "      <td>2020-04-03</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>91159.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19233</th>\n",
       "      <td>2020-04-03</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>276547.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19460</th>\n",
       "      <td>2020-04-04</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>96092.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19515</th>\n",
       "      <td>2020-04-04</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>309699.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55903</th>\n",
       "      <td>2020-08-19</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>229706.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55943</th>\n",
       "      <td>2020-08-19</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5529824.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56168</th>\n",
       "      <td>2020-08-20</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>231292.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56208</th>\n",
       "      <td>2020-08-20</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5573847.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56435</th>\n",
       "      <td>2020-08-21</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>233029.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56475</th>\n",
       "      <td>2020-08-21</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5622470.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56701</th>\n",
       "      <td>2020-08-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>233861.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56741</th>\n",
       "      <td>2020-08-22</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5667070.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56967</th>\n",
       "      <td>2020-08-23</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>234494.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57006</th>\n",
       "      <td>2020-08-23</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5701645.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57233</th>\n",
       "      <td>2020-08-24</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>236122.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57273</th>\n",
       "      <td>2020-08-24</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5739536.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57499</th>\n",
       "      <td>2020-08-25</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>237583.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57539</th>\n",
       "      <td>2020-08-25</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5777710.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57765</th>\n",
       "      <td>2020-08-26</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>239010.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57805</th>\n",
       "      <td>2020-08-26</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5821819.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58030</th>\n",
       "      <td>2020-08-27</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>240571.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58085</th>\n",
       "      <td>2020-08-27</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5867785.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58297</th>\n",
       "      <td>2020-08-28</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>242126.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58337</th>\n",
       "      <td>2020-08-28</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5913941.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58561</th>\n",
       "      <td>2020-08-29</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>242835.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58601</th>\n",
       "      <td>2020-08-29</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5961094.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58829</th>\n",
       "      <td>2020-08-30</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>243305.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58870</th>\n",
       "      <td>2020-08-30</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>5996431.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59093</th>\n",
       "      <td>2020-08-31</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>244802.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59133</th>\n",
       "      <td>2020-08-31</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>6030587.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59361</th>\n",
       "      <td>2020-09-01</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>246015.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59402</th>\n",
       "      <td>2020-09-01</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>6073840.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59626</th>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>247411.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59668</th>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>US</td>\n",
       "      <td>6113510.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>332 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            date state  country  confirmed\n",
       "15736 2020-03-21    no  Germany    22213.0\n",
       "15776 2020-03-21    no       US    24508.0\n",
       "16003 2020-03-22    no  Germany    24873.0\n",
       "16043 2020-03-22    no       US    33152.0\n",
       "16267 2020-03-23    no  Germany    29056.0\n",
       "16307 2020-03-23    no       US    43850.0\n",
       "16534 2020-03-24    no  Germany    32986.0\n",
       "16575 2020-03-24    no       US    54112.0\n",
       "16800 2020-03-25    no  Germany    37323.0\n",
       "16855 2020-03-25    no       US    66055.0\n",
       "17066 2020-03-26    no  Germany    43938.0\n",
       "17106 2020-03-26    no       US    83611.0\n",
       "17333 2020-03-27    no  Germany    50871.0\n",
       "17373 2020-03-27    no       US   102101.0\n",
       "17599 2020-03-28    no  Germany    57695.0\n",
       "17638 2020-03-28    no       US   122059.0\n",
       "17864 2020-03-29    no  Germany    62095.0\n",
       "17919 2020-03-29    no       US   141205.0\n",
       "18131 2020-03-30    no  Germany    66885.0\n",
       "18172 2020-03-30    no       US   162707.0\n",
       "18396 2020-03-31    no  Germany    71808.0\n",
       "18437 2020-03-31    no       US   188744.0\n",
       "18661 2020-04-01    no  Germany    77872.0\n",
       "18717 2020-04-01    no       US   214205.0\n",
       "18929 2020-04-02    no  Germany    84794.0\n",
       "18969 2020-04-02    no       US   244610.0\n",
       "19193 2020-04-03    no  Germany    91159.0\n",
       "19233 2020-04-03    no       US   276547.0\n",
       "19460 2020-04-04    no  Germany    96092.0\n",
       "19515 2020-04-04    no       US   309699.0\n",
       "...          ...   ...      ...        ...\n",
       "55903 2020-08-19    no  Germany   229706.0\n",
       "55943 2020-08-19    no       US  5529824.0\n",
       "56168 2020-08-20    no  Germany   231292.0\n",
       "56208 2020-08-20    no       US  5573847.0\n",
       "56435 2020-08-21    no  Germany   233029.0\n",
       "56475 2020-08-21    no       US  5622470.0\n",
       "56701 2020-08-22    no  Germany   233861.0\n",
       "56741 2020-08-22    no       US  5667070.0\n",
       "56967 2020-08-23    no  Germany   234494.0\n",
       "57006 2020-08-23    no       US  5701645.0\n",
       "57233 2020-08-24    no  Germany   236122.0\n",
       "57273 2020-08-24    no       US  5739536.0\n",
       "57499 2020-08-25    no  Germany   237583.0\n",
       "57539 2020-08-25    no       US  5777710.0\n",
       "57765 2020-08-26    no  Germany   239010.0\n",
       "57805 2020-08-26    no       US  5821819.0\n",
       "58030 2020-08-27    no  Germany   240571.0\n",
       "58085 2020-08-27    no       US  5867785.0\n",
       "58297 2020-08-28    no  Germany   242126.0\n",
       "58337 2020-08-28    no       US  5913941.0\n",
       "58561 2020-08-29    no  Germany   242835.0\n",
       "58601 2020-08-29    no       US  5961094.0\n",
       "58829 2020-08-30    no  Germany   243305.0\n",
       "58870 2020-08-30    no       US  5996431.0\n",
       "59093 2020-08-31    no  Germany   244802.0\n",
       "59133 2020-08-31    no       US  6030587.0\n",
       "59361 2020-09-01    no  Germany   246015.0\n",
       "59402 2020-09-01    no       US  6073840.0\n",
       "59626 2020-09-02    no  Germany   247411.0\n",
       "59668 2020-09-02    no       US  6113510.0\n",
       "\n",
       "[332 rows x 4 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "pd_DR_result=pd_JH_data[['state','country','confirmed']].groupby(['state','country']).apply(rolling_reg,'confirmed').reset_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>state</th>\n",
       "      <th>country</th>\n",
       "      <th>level_2</th>\n",
       "      <th>confirmed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>465</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>701</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>966</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>1263</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>1498</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>1764</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>2030</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>2328</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>2527</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>2828</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>3059</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>3325</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>3591</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>3892</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>4158</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>4456</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>4690</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>4956</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>5221</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>5489</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>5753</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>6019</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>6287</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>6551</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>6817</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>7084</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>7350</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>7616</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>7882</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59820</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>51966</td>\n",
       "      <td>26.148889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59821</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>52200</td>\n",
       "      <td>56.155251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59822</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>52534</td>\n",
       "      <td>71.209040</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59823</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>52800</td>\n",
       "      <td>36.713043</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59824</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>53066</td>\n",
       "      <td>36.754237</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59825</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>53295</td>\n",
       "      <td>45.043771</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59826</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>53598</td>\n",
       "      <td>52.842004</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59827</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>53863</td>\n",
       "      <td>55.074951</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59828</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>54094</td>\n",
       "      <td>65.478161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59829</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>54396</td>\n",
       "      <td>55.980620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59830</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>54662</td>\n",
       "      <td>54.698324</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59831</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>54928</td>\n",
       "      <td>53.616487</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59832</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>55157</td>\n",
       "      <td>53.705467</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59833</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>55460</td>\n",
       "      <td>78.520202</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59834</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>55690</td>\n",
       "      <td>89.866097</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59835</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>55924</td>\n",
       "      <td>31.495522</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59836</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>56258</td>\n",
       "      <td>29.455949</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59837</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>56524</td>\n",
       "      <td>65.678295</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59838</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>56790</td>\n",
       "      <td>77.617117</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59839</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>57019</td>\n",
       "      <td>101.249275</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59840</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>57322</td>\n",
       "      <td>66.393597</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59841</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>57552</td>\n",
       "      <td>44.604010</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59842</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>57786</td>\n",
       "      <td>67.202578</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59843</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>58083</td>\n",
       "      <td>129.131944</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59844</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>58319</td>\n",
       "      <td>91.121655</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59845</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>58614</td>\n",
       "      <td>110.614035</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59846</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>58850</td>\n",
       "      <td>532.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59847</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>59146</td>\n",
       "      <td>140.501832</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59848</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>59382</td>\n",
       "      <td>87.290249</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59849</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>59849</td>\n",
       "      <td>92.115839</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>59850 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         state   country  level_2   confirmed\n",
       "0      Alberta    Canada        0         NaN\n",
       "1      Alberta    Canada      465         NaN\n",
       "2      Alberta    Canada      701         NaN\n",
       "3      Alberta    Canada      966         NaN\n",
       "4      Alberta    Canada     1263         NaN\n",
       "5      Alberta    Canada     1498         NaN\n",
       "6      Alberta    Canada     1764         NaN\n",
       "7      Alberta    Canada     2030         NaN\n",
       "8      Alberta    Canada     2328         NaN\n",
       "9      Alberta    Canada     2527         NaN\n",
       "10     Alberta    Canada     2828         NaN\n",
       "11     Alberta    Canada     3059         NaN\n",
       "12     Alberta    Canada     3325         NaN\n",
       "13     Alberta    Canada     3591         NaN\n",
       "14     Alberta    Canada     3892         NaN\n",
       "15     Alberta    Canada     4158         NaN\n",
       "16     Alberta    Canada     4456         NaN\n",
       "17     Alberta    Canada     4690         NaN\n",
       "18     Alberta    Canada     4956         NaN\n",
       "19     Alberta    Canada     5221         NaN\n",
       "20     Alberta    Canada     5489         NaN\n",
       "21     Alberta    Canada     5753         NaN\n",
       "22     Alberta    Canada     6019         NaN\n",
       "23     Alberta    Canada     6287         NaN\n",
       "24     Alberta    Canada     6551         NaN\n",
       "25     Alberta    Canada     6817         NaN\n",
       "26     Alberta    Canada     7084         NaN\n",
       "27     Alberta    Canada     7350         NaN\n",
       "28     Alberta    Canada     7616         NaN\n",
       "29     Alberta    Canada     7882         NaN\n",
       "...        ...       ...      ...         ...\n",
       "59820       no  Zimbabwe    51966   26.148889\n",
       "59821       no  Zimbabwe    52200   56.155251\n",
       "59822       no  Zimbabwe    52534   71.209040\n",
       "59823       no  Zimbabwe    52800   36.713043\n",
       "59824       no  Zimbabwe    53066   36.754237\n",
       "59825       no  Zimbabwe    53295   45.043771\n",
       "59826       no  Zimbabwe    53598   52.842004\n",
       "59827       no  Zimbabwe    53863   55.074951\n",
       "59828       no  Zimbabwe    54094   65.478161\n",
       "59829       no  Zimbabwe    54396   55.980620\n",
       "59830       no  Zimbabwe    54662   54.698324\n",
       "59831       no  Zimbabwe    54928   53.616487\n",
       "59832       no  Zimbabwe    55157   53.705467\n",
       "59833       no  Zimbabwe    55460   78.520202\n",
       "59834       no  Zimbabwe    55690   89.866097\n",
       "59835       no  Zimbabwe    55924   31.495522\n",
       "59836       no  Zimbabwe    56258   29.455949\n",
       "59837       no  Zimbabwe    56524   65.678295\n",
       "59838       no  Zimbabwe    56790   77.617117\n",
       "59839       no  Zimbabwe    57019  101.249275\n",
       "59840       no  Zimbabwe    57322   66.393597\n",
       "59841       no  Zimbabwe    57552   44.604010\n",
       "59842       no  Zimbabwe    57786   67.202578\n",
       "59843       no  Zimbabwe    58083  129.131944\n",
       "59844       no  Zimbabwe    58319   91.121655\n",
       "59845       no  Zimbabwe    58614  110.614035\n",
       "59846       no  Zimbabwe    58850  532.500000\n",
       "59847       no  Zimbabwe    59146  140.501832\n",
       "59848       no  Zimbabwe    59382   87.290249\n",
       "59849       no  Zimbabwe    59849   92.115839\n",
       "\n",
       "[59850 rows x 4 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_DR_result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>state</th>\n",
       "      <th>country</th>\n",
       "      <th>index</th>\n",
       "      <th>doubling_rate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>465</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>701</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>966</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>1263</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>1498</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>1764</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>2030</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>2328</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>2527</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>2828</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>3059</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>3325</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>3591</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>3892</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>4158</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>4456</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>4690</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>4956</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>5221</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>5489</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>5753</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>6019</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>6287</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>6551</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>6817</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>7084</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>7350</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>7616</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>7882</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59820</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>51966</td>\n",
       "      <td>26.148889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59821</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>52200</td>\n",
       "      <td>56.155251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59822</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>52534</td>\n",
       "      <td>71.209040</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59823</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>52800</td>\n",
       "      <td>36.713043</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59824</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>53066</td>\n",
       "      <td>36.754237</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59825</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>53295</td>\n",
       "      <td>45.043771</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59826</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>53598</td>\n",
       "      <td>52.842004</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59827</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>53863</td>\n",
       "      <td>55.074951</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59828</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>54094</td>\n",
       "      <td>65.478161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59829</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>54396</td>\n",
       "      <td>55.980620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59830</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>54662</td>\n",
       "      <td>54.698324</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59831</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>54928</td>\n",
       "      <td>53.616487</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59832</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>55157</td>\n",
       "      <td>53.705467</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59833</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>55460</td>\n",
       "      <td>78.520202</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59834</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>55690</td>\n",
       "      <td>89.866097</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59835</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>55924</td>\n",
       "      <td>31.495522</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59836</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>56258</td>\n",
       "      <td>29.455949</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59837</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>56524</td>\n",
       "      <td>65.678295</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59838</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>56790</td>\n",
       "      <td>77.617117</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59839</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>57019</td>\n",
       "      <td>101.249275</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59840</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>57322</td>\n",
       "      <td>66.393597</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59841</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>57552</td>\n",
       "      <td>44.604010</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59842</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>57786</td>\n",
       "      <td>67.202578</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59843</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>58083</td>\n",
       "      <td>129.131944</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59844</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>58319</td>\n",
       "      <td>91.121655</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59845</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>58614</td>\n",
       "      <td>110.614035</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59846</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>58850</td>\n",
       "      <td>532.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59847</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>59146</td>\n",
       "      <td>140.501832</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59848</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>59382</td>\n",
       "      <td>87.290249</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59849</th>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>59849</td>\n",
       "      <td>92.115839</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>59850 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         state   country  index  doubling_rate\n",
       "0      Alberta    Canada      0            NaN\n",
       "1      Alberta    Canada    465            NaN\n",
       "2      Alberta    Canada    701            NaN\n",
       "3      Alberta    Canada    966            NaN\n",
       "4      Alberta    Canada   1263            NaN\n",
       "5      Alberta    Canada   1498            NaN\n",
       "6      Alberta    Canada   1764            NaN\n",
       "7      Alberta    Canada   2030            NaN\n",
       "8      Alberta    Canada   2328            NaN\n",
       "9      Alberta    Canada   2527            NaN\n",
       "10     Alberta    Canada   2828            NaN\n",
       "11     Alberta    Canada   3059            NaN\n",
       "12     Alberta    Canada   3325            NaN\n",
       "13     Alberta    Canada   3591            NaN\n",
       "14     Alberta    Canada   3892            NaN\n",
       "15     Alberta    Canada   4158            NaN\n",
       "16     Alberta    Canada   4456            NaN\n",
       "17     Alberta    Canada   4690            NaN\n",
       "18     Alberta    Canada   4956            NaN\n",
       "19     Alberta    Canada   5221            NaN\n",
       "20     Alberta    Canada   5489            NaN\n",
       "21     Alberta    Canada   5753            NaN\n",
       "22     Alberta    Canada   6019            NaN\n",
       "23     Alberta    Canada   6287            NaN\n",
       "24     Alberta    Canada   6551            NaN\n",
       "25     Alberta    Canada   6817            NaN\n",
       "26     Alberta    Canada   7084            NaN\n",
       "27     Alberta    Canada   7350            NaN\n",
       "28     Alberta    Canada   7616            NaN\n",
       "29     Alberta    Canada   7882            NaN\n",
       "...        ...       ...    ...            ...\n",
       "59820       no  Zimbabwe  51966      26.148889\n",
       "59821       no  Zimbabwe  52200      56.155251\n",
       "59822       no  Zimbabwe  52534      71.209040\n",
       "59823       no  Zimbabwe  52800      36.713043\n",
       "59824       no  Zimbabwe  53066      36.754237\n",
       "59825       no  Zimbabwe  53295      45.043771\n",
       "59826       no  Zimbabwe  53598      52.842004\n",
       "59827       no  Zimbabwe  53863      55.074951\n",
       "59828       no  Zimbabwe  54094      65.478161\n",
       "59829       no  Zimbabwe  54396      55.980620\n",
       "59830       no  Zimbabwe  54662      54.698324\n",
       "59831       no  Zimbabwe  54928      53.616487\n",
       "59832       no  Zimbabwe  55157      53.705467\n",
       "59833       no  Zimbabwe  55460      78.520202\n",
       "59834       no  Zimbabwe  55690      89.866097\n",
       "59835       no  Zimbabwe  55924      31.495522\n",
       "59836       no  Zimbabwe  56258      29.455949\n",
       "59837       no  Zimbabwe  56524      65.678295\n",
       "59838       no  Zimbabwe  56790      77.617117\n",
       "59839       no  Zimbabwe  57019     101.249275\n",
       "59840       no  Zimbabwe  57322      66.393597\n",
       "59841       no  Zimbabwe  57552      44.604010\n",
       "59842       no  Zimbabwe  57786      67.202578\n",
       "59843       no  Zimbabwe  58083     129.131944\n",
       "59844       no  Zimbabwe  58319      91.121655\n",
       "59845       no  Zimbabwe  58614     110.614035\n",
       "59846       no  Zimbabwe  58850     532.500000\n",
       "59847       no  Zimbabwe  59146     140.501832\n",
       "59848       no  Zimbabwe  59382      87.290249\n",
       "59849       no  Zimbabwe  59849      92.115839\n",
       "\n",
       "[59850 rows x 4 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_DR_result=pd_DR_result.rename(columns={'confirmed':'doubling_rate','level_2':'index'})\n",
    "pd_DR_result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>date</th>\n",
       "      <th>state</th>\n",
       "      <th>country</th>\n",
       "      <th>confirmed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Korea, South</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Kosovo</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Kuwait</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Kyrgyzstan</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Laos</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Latvia</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Lebanon</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Lesotho</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Liberia</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Libya</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>11</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Liechtenstein</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Lithuania</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>13</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Luxembourg</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>14</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>MS Zaandam</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>15</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Madagascar</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Malawi</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Malaysia</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>18</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Maldives</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mali</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>20</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Malta</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>21</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mauritania</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>22</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mauritius</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>23</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mexico</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>24</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Moldova</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>25</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Monaco</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>26</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mongolia</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>27</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Montenegro</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>28</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Morocco</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>29</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mozambique</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59820</th>\n",
       "      <td>59820</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>South Australia</td>\n",
       "      <td>Australia</td>\n",
       "      <td>463.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59821</th>\n",
       "      <td>59821</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>St Martin</td>\n",
       "      <td>France</td>\n",
       "      <td>239.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59822</th>\n",
       "      <td>59822</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Tasmania</td>\n",
       "      <td>Australia</td>\n",
       "      <td>230.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59823</th>\n",
       "      <td>59823</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Tianjin</td>\n",
       "      <td>China</td>\n",
       "      <td>229.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59824</th>\n",
       "      <td>59824</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Tibet</td>\n",
       "      <td>China</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59825</th>\n",
       "      <td>59825</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Turks and Caicos Islands</td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>538.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59826</th>\n",
       "      <td>59826</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Victoria</td>\n",
       "      <td>Australia</td>\n",
       "      <td>19336.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59827</th>\n",
       "      <td>59827</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Western Australia</td>\n",
       "      <td>Australia</td>\n",
       "      <td>655.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59828</th>\n",
       "      <td>59828</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Xinjiang</td>\n",
       "      <td>China</td>\n",
       "      <td>902.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59829</th>\n",
       "      <td>59829</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Yukon</td>\n",
       "      <td>Canada</td>\n",
       "      <td>15.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59830</th>\n",
       "      <td>59830</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Yunnan</td>\n",
       "      <td>China</td>\n",
       "      <td>199.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59831</th>\n",
       "      <td>59831</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Zhejiang</td>\n",
       "      <td>China</td>\n",
       "      <td>1278.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59832</th>\n",
       "      <td>59832</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Shandong</td>\n",
       "      <td>China</td>\n",
       "      <td>831.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59833</th>\n",
       "      <td>59833</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>38243.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59834</th>\n",
       "      <td>59834</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Algeria</td>\n",
       "      <td>45158.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59835</th>\n",
       "      <td>59835</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Andorra</td>\n",
       "      <td>1199.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59836</th>\n",
       "      <td>59836</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Angola</td>\n",
       "      <td>2777.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59837</th>\n",
       "      <td>59837</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Antigua and Barbuda</td>\n",
       "      <td>94.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59838</th>\n",
       "      <td>59838</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>439172.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59839</th>\n",
       "      <td>59839</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Armenia</td>\n",
       "      <td>44075.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59840</th>\n",
       "      <td>59840</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Austria</td>\n",
       "      <td>27969.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59841</th>\n",
       "      <td>59841</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Azerbaijan</td>\n",
       "      <td>36732.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59842</th>\n",
       "      <td>59842</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Bahamas</td>\n",
       "      <td>2337.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59843</th>\n",
       "      <td>59843</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Bahrain</td>\n",
       "      <td>52807.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59844</th>\n",
       "      <td>59844</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Bangladesh</td>\n",
       "      <td>317528.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59845</th>\n",
       "      <td>59845</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Barbados</td>\n",
       "      <td>176.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59846</th>\n",
       "      <td>59846</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Belarus</td>\n",
       "      <td>72141.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59847</th>\n",
       "      <td>59847</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Belgium</td>\n",
       "      <td>85911.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59848</th>\n",
       "      <td>59848</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Albania</td>\n",
       "      <td>9728.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59849</th>\n",
       "      <td>59849</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>6638.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>59850 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       index       date                     state              country  \\\n",
       "0          0 2020-01-22                   Alberta               Canada   \n",
       "1          1 2020-01-22                        no         Korea, South   \n",
       "2          2 2020-01-22                        no               Kosovo   \n",
       "3          3 2020-01-22                        no               Kuwait   \n",
       "4          4 2020-01-22                        no           Kyrgyzstan   \n",
       "5          5 2020-01-22                        no                 Laos   \n",
       "6          6 2020-01-22                        no               Latvia   \n",
       "7          7 2020-01-22                        no              Lebanon   \n",
       "8          8 2020-01-22                        no              Lesotho   \n",
       "9          9 2020-01-22                        no              Liberia   \n",
       "10        10 2020-01-22                        no                Libya   \n",
       "11        11 2020-01-22                        no        Liechtenstein   \n",
       "12        12 2020-01-22                        no            Lithuania   \n",
       "13        13 2020-01-22                        no           Luxembourg   \n",
       "14        14 2020-01-22                        no           MS Zaandam   \n",
       "15        15 2020-01-22                        no           Madagascar   \n",
       "16        16 2020-01-22                        no               Malawi   \n",
       "17        17 2020-01-22                        no             Malaysia   \n",
       "18        18 2020-01-22                        no             Maldives   \n",
       "19        19 2020-01-22                        no                 Mali   \n",
       "20        20 2020-01-22                        no                Malta   \n",
       "21        21 2020-01-22                        no           Mauritania   \n",
       "22        22 2020-01-22                        no            Mauritius   \n",
       "23        23 2020-01-22                        no               Mexico   \n",
       "24        24 2020-01-22                        no              Moldova   \n",
       "25        25 2020-01-22                        no               Monaco   \n",
       "26        26 2020-01-22                        no             Mongolia   \n",
       "27        27 2020-01-22                        no           Montenegro   \n",
       "28        28 2020-01-22                        no              Morocco   \n",
       "29        29 2020-01-22                        no           Mozambique   \n",
       "...      ...        ...                       ...                  ...   \n",
       "59820  59820 2020-09-02           South Australia            Australia   \n",
       "59821  59821 2020-09-02                 St Martin               France   \n",
       "59822  59822 2020-09-02                  Tasmania            Australia   \n",
       "59823  59823 2020-09-02                   Tianjin                China   \n",
       "59824  59824 2020-09-02                     Tibet                China   \n",
       "59825  59825 2020-09-02  Turks and Caicos Islands       United Kingdom   \n",
       "59826  59826 2020-09-02                  Victoria            Australia   \n",
       "59827  59827 2020-09-02         Western Australia            Australia   \n",
       "59828  59828 2020-09-02                  Xinjiang                China   \n",
       "59829  59829 2020-09-02                     Yukon               Canada   \n",
       "59830  59830 2020-09-02                    Yunnan                China   \n",
       "59831  59831 2020-09-02                  Zhejiang                China   \n",
       "59832  59832 2020-09-02                  Shandong                China   \n",
       "59833  59833 2020-09-02                        no          Afghanistan   \n",
       "59834  59834 2020-09-02                        no              Algeria   \n",
       "59835  59835 2020-09-02                        no              Andorra   \n",
       "59836  59836 2020-09-02                        no               Angola   \n",
       "59837  59837 2020-09-02                        no  Antigua and Barbuda   \n",
       "59838  59838 2020-09-02                        no            Argentina   \n",
       "59839  59839 2020-09-02                        no              Armenia   \n",
       "59840  59840 2020-09-02                        no              Austria   \n",
       "59841  59841 2020-09-02                        no           Azerbaijan   \n",
       "59842  59842 2020-09-02                        no              Bahamas   \n",
       "59843  59843 2020-09-02                        no              Bahrain   \n",
       "59844  59844 2020-09-02                        no           Bangladesh   \n",
       "59845  59845 2020-09-02                        no             Barbados   \n",
       "59846  59846 2020-09-02                        no              Belarus   \n",
       "59847  59847 2020-09-02                        no              Belgium   \n",
       "59848  59848 2020-09-02                        no              Albania   \n",
       "59849  59849 2020-09-02                        no             Zimbabwe   \n",
       "\n",
       "       confirmed  \n",
       "0            0.0  \n",
       "1            1.0  \n",
       "2            0.0  \n",
       "3            0.0  \n",
       "4            0.0  \n",
       "5            0.0  \n",
       "6            0.0  \n",
       "7            0.0  \n",
       "8            0.0  \n",
       "9            0.0  \n",
       "10           0.0  \n",
       "11           0.0  \n",
       "12           0.0  \n",
       "13           0.0  \n",
       "14           0.0  \n",
       "15           0.0  \n",
       "16           0.0  \n",
       "17           0.0  \n",
       "18           0.0  \n",
       "19           0.0  \n",
       "20           0.0  \n",
       "21           0.0  \n",
       "22           0.0  \n",
       "23           0.0  \n",
       "24           0.0  \n",
       "25           0.0  \n",
       "26           0.0  \n",
       "27           0.0  \n",
       "28           0.0  \n",
       "29           0.0  \n",
       "...          ...  \n",
       "59820      463.0  \n",
       "59821      239.0  \n",
       "59822      230.0  \n",
       "59823      229.0  \n",
       "59824        1.0  \n",
       "59825      538.0  \n",
       "59826    19336.0  \n",
       "59827      655.0  \n",
       "59828      902.0  \n",
       "59829       15.0  \n",
       "59830      199.0  \n",
       "59831     1278.0  \n",
       "59832      831.0  \n",
       "59833    38243.0  \n",
       "59834    45158.0  \n",
       "59835     1199.0  \n",
       "59836     2777.0  \n",
       "59837       94.0  \n",
       "59838   439172.0  \n",
       "59839    44075.0  \n",
       "59840    27969.0  \n",
       "59841    36732.0  \n",
       "59842     2337.0  \n",
       "59843    52807.0  \n",
       "59844   317528.0  \n",
       "59845      176.0  \n",
       "59846    72141.0  \n",
       "59847    85911.0  \n",
       "59848     9728.0  \n",
       "59849     6638.0  \n",
       "\n",
       "[59850 rows x 5 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_JH_data=pd_JH_data.reset_index()\n",
    "pd_JH_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "pd_result_larg=pd.merge(pd_JH_data,pd_DR_result[['index','doubling_rate']],on=['index'],how='left')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>date</th>\n",
       "      <th>state</th>\n",
       "      <th>country</th>\n",
       "      <th>confirmed</th>\n",
       "      <th>doubling_rate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>Alberta</td>\n",
       "      <td>Canada</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Korea, South</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Kosovo</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Kuwait</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Kyrgyzstan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Laos</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Latvia</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Lebanon</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Lesotho</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Liberia</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Libya</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>11</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Liechtenstein</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Lithuania</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>13</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Luxembourg</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>14</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>MS Zaandam</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>15</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Madagascar</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Malawi</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Malaysia</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>18</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Maldives</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mali</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>20</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Malta</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>21</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mauritania</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>22</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mauritius</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>23</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mexico</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>24</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Moldova</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>25</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Monaco</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>26</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mongolia</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>27</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Montenegro</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>28</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Morocco</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>29</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Mozambique</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59820</th>\n",
       "      <td>59820</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>South Australia</td>\n",
       "      <td>Australia</td>\n",
       "      <td>463.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59821</th>\n",
       "      <td>59821</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>St Martin</td>\n",
       "      <td>France</td>\n",
       "      <td>239.0</td>\n",
       "      <td>16.051282</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59822</th>\n",
       "      <td>59822</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Tasmania</td>\n",
       "      <td>Australia</td>\n",
       "      <td>230.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59823</th>\n",
       "      <td>59823</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Tianjin</td>\n",
       "      <td>China</td>\n",
       "      <td>229.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59824</th>\n",
       "      <td>59824</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Tibet</td>\n",
       "      <td>China</td>\n",
       "      <td>1.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59825</th>\n",
       "      <td>59825</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Turks and Caicos Islands</td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>538.0</td>\n",
       "      <td>34.200000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59826</th>\n",
       "      <td>59826</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Victoria</td>\n",
       "      <td>Australia</td>\n",
       "      <td>19336.0</td>\n",
       "      <td>193.269360</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59827</th>\n",
       "      <td>59827</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Western Australia</td>\n",
       "      <td>Australia</td>\n",
       "      <td>655.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59828</th>\n",
       "      <td>59828</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Xinjiang</td>\n",
       "      <td>China</td>\n",
       "      <td>902.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59829</th>\n",
       "      <td>59829</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Yukon</td>\n",
       "      <td>Canada</td>\n",
       "      <td>15.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59830</th>\n",
       "      <td>59830</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Yunnan</td>\n",
       "      <td>China</td>\n",
       "      <td>199.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59831</th>\n",
       "      <td>59831</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Zhejiang</td>\n",
       "      <td>China</td>\n",
       "      <td>1278.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59832</th>\n",
       "      <td>59832</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>Shandong</td>\n",
       "      <td>China</td>\n",
       "      <td>831.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59833</th>\n",
       "      <td>59833</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>38243.0</td>\n",
       "      <td>978.521368</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59834</th>\n",
       "      <td>59834</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Algeria</td>\n",
       "      <td>45158.0</td>\n",
       "      <td>134.025100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59835</th>\n",
       "      <td>59835</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Andorra</td>\n",
       "      <td>1199.0</td>\n",
       "      <td>102.159420</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59836</th>\n",
       "      <td>59836</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Angola</td>\n",
       "      <td>2777.0</td>\n",
       "      <td>43.227642</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59837</th>\n",
       "      <td>59837</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Antigua and Barbuda</td>\n",
       "      <td>94.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59838</th>\n",
       "      <td>59838</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>439172.0</td>\n",
       "      <td>38.966600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59839</th>\n",
       "      <td>59839</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Armenia</td>\n",
       "      <td>44075.0</td>\n",
       "      <td>297.716553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59840</th>\n",
       "      <td>59840</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Austria</td>\n",
       "      <td>27969.0</td>\n",
       "      <td>103.267420</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59841</th>\n",
       "      <td>59841</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Azerbaijan</td>\n",
       "      <td>36732.0</td>\n",
       "      <td>245.341190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59842</th>\n",
       "      <td>59842</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Bahamas</td>\n",
       "      <td>2337.0</td>\n",
       "      <td>36.944444</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59843</th>\n",
       "      <td>59843</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Bahrain</td>\n",
       "      <td>52807.0</td>\n",
       "      <td>124.524152</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59844</th>\n",
       "      <td>59844</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Bangladesh</td>\n",
       "      <td>317528.0</td>\n",
       "      <td>138.080612</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59845</th>\n",
       "      <td>59845</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Barbados</td>\n",
       "      <td>176.0</td>\n",
       "      <td>174.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59846</th>\n",
       "      <td>59846</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Belarus</td>\n",
       "      <td>72141.0</td>\n",
       "      <td>482.100671</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59847</th>\n",
       "      <td>59847</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Belgium</td>\n",
       "      <td>85911.0</td>\n",
       "      <td>252.465679</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59848</th>\n",
       "      <td>59848</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Albania</td>\n",
       "      <td>9728.0</td>\n",
       "      <td>88.448062</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59849</th>\n",
       "      <td>59849</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Zimbabwe</td>\n",
       "      <td>6638.0</td>\n",
       "      <td>92.115839</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>59850 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       index       date                     state              country  \\\n",
       "0          0 2020-01-22                   Alberta               Canada   \n",
       "1          1 2020-01-22                        no         Korea, South   \n",
       "2          2 2020-01-22                        no               Kosovo   \n",
       "3          3 2020-01-22                        no               Kuwait   \n",
       "4          4 2020-01-22                        no           Kyrgyzstan   \n",
       "5          5 2020-01-22                        no                 Laos   \n",
       "6          6 2020-01-22                        no               Latvia   \n",
       "7          7 2020-01-22                        no              Lebanon   \n",
       "8          8 2020-01-22                        no              Lesotho   \n",
       "9          9 2020-01-22                        no              Liberia   \n",
       "10        10 2020-01-22                        no                Libya   \n",
       "11        11 2020-01-22                        no        Liechtenstein   \n",
       "12        12 2020-01-22                        no            Lithuania   \n",
       "13        13 2020-01-22                        no           Luxembourg   \n",
       "14        14 2020-01-22                        no           MS Zaandam   \n",
       "15        15 2020-01-22                        no           Madagascar   \n",
       "16        16 2020-01-22                        no               Malawi   \n",
       "17        17 2020-01-22                        no             Malaysia   \n",
       "18        18 2020-01-22                        no             Maldives   \n",
       "19        19 2020-01-22                        no                 Mali   \n",
       "20        20 2020-01-22                        no                Malta   \n",
       "21        21 2020-01-22                        no           Mauritania   \n",
       "22        22 2020-01-22                        no            Mauritius   \n",
       "23        23 2020-01-22                        no               Mexico   \n",
       "24        24 2020-01-22                        no              Moldova   \n",
       "25        25 2020-01-22                        no               Monaco   \n",
       "26        26 2020-01-22                        no             Mongolia   \n",
       "27        27 2020-01-22                        no           Montenegro   \n",
       "28        28 2020-01-22                        no              Morocco   \n",
       "29        29 2020-01-22                        no           Mozambique   \n",
       "...      ...        ...                       ...                  ...   \n",
       "59820  59820 2020-09-02           South Australia            Australia   \n",
       "59821  59821 2020-09-02                 St Martin               France   \n",
       "59822  59822 2020-09-02                  Tasmania            Australia   \n",
       "59823  59823 2020-09-02                   Tianjin                China   \n",
       "59824  59824 2020-09-02                     Tibet                China   \n",
       "59825  59825 2020-09-02  Turks and Caicos Islands       United Kingdom   \n",
       "59826  59826 2020-09-02                  Victoria            Australia   \n",
       "59827  59827 2020-09-02         Western Australia            Australia   \n",
       "59828  59828 2020-09-02                  Xinjiang                China   \n",
       "59829  59829 2020-09-02                     Yukon               Canada   \n",
       "59830  59830 2020-09-02                    Yunnan                China   \n",
       "59831  59831 2020-09-02                  Zhejiang                China   \n",
       "59832  59832 2020-09-02                  Shandong                China   \n",
       "59833  59833 2020-09-02                        no          Afghanistan   \n",
       "59834  59834 2020-09-02                        no              Algeria   \n",
       "59835  59835 2020-09-02                        no              Andorra   \n",
       "59836  59836 2020-09-02                        no               Angola   \n",
       "59837  59837 2020-09-02                        no  Antigua and Barbuda   \n",
       "59838  59838 2020-09-02                        no            Argentina   \n",
       "59839  59839 2020-09-02                        no              Armenia   \n",
       "59840  59840 2020-09-02                        no              Austria   \n",
       "59841  59841 2020-09-02                        no           Azerbaijan   \n",
       "59842  59842 2020-09-02                        no              Bahamas   \n",
       "59843  59843 2020-09-02                        no              Bahrain   \n",
       "59844  59844 2020-09-02                        no           Bangladesh   \n",
       "59845  59845 2020-09-02                        no             Barbados   \n",
       "59846  59846 2020-09-02                        no              Belarus   \n",
       "59847  59847 2020-09-02                        no              Belgium   \n",
       "59848  59848 2020-09-02                        no              Albania   \n",
       "59849  59849 2020-09-02                        no             Zimbabwe   \n",
       "\n",
       "       confirmed  doubling_rate  \n",
       "0            0.0            NaN  \n",
       "1            1.0            NaN  \n",
       "2            0.0            NaN  \n",
       "3            0.0            NaN  \n",
       "4            0.0            NaN  \n",
       "5            0.0            NaN  \n",
       "6            0.0            NaN  \n",
       "7            0.0            NaN  \n",
       "8            0.0            NaN  \n",
       "9            0.0            NaN  \n",
       "10           0.0            NaN  \n",
       "11           0.0            NaN  \n",
       "12           0.0            NaN  \n",
       "13           0.0            NaN  \n",
       "14           0.0            NaN  \n",
       "15           0.0            NaN  \n",
       "16           0.0            NaN  \n",
       "17           0.0            NaN  \n",
       "18           0.0            NaN  \n",
       "19           0.0            NaN  \n",
       "20           0.0            NaN  \n",
       "21           0.0            NaN  \n",
       "22           0.0            NaN  \n",
       "23           0.0            NaN  \n",
       "24           0.0            NaN  \n",
       "25           0.0            NaN  \n",
       "26           0.0            NaN  \n",
       "27           0.0            NaN  \n",
       "28           0.0            NaN  \n",
       "29           0.0            NaN  \n",
       "...          ...            ...  \n",
       "59820      463.0            inf  \n",
       "59821      239.0      16.051282  \n",
       "59822      230.0            inf  \n",
       "59823      229.0            inf  \n",
       "59824        1.0            inf  \n",
       "59825      538.0      34.200000  \n",
       "59826    19336.0     193.269360  \n",
       "59827      655.0            inf  \n",
       "59828      902.0            inf  \n",
       "59829       15.0            inf  \n",
       "59830      199.0            inf  \n",
       "59831     1278.0            inf  \n",
       "59832      831.0            inf  \n",
       "59833    38243.0     978.521368  \n",
       "59834    45158.0     134.025100  \n",
       "59835     1199.0     102.159420  \n",
       "59836     2777.0      43.227642  \n",
       "59837       94.0            inf  \n",
       "59838   439172.0      38.966600  \n",
       "59839    44075.0     297.716553  \n",
       "59840    27969.0     103.267420  \n",
       "59841    36732.0     245.341190  \n",
       "59842     2337.0      36.944444  \n",
       "59843    52807.0     124.524152  \n",
       "59844   317528.0     138.080612  \n",
       "59845      176.0     174.333333  \n",
       "59846    72141.0     482.100671  \n",
       "59847    85911.0     252.465679  \n",
       "59848     9728.0      88.448062  \n",
       "59849     6638.0      92.115839  \n",
       "\n",
       "[59850 rows x 6 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_result_larg"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>date</th>\n",
       "      <th>state</th>\n",
       "      <th>country</th>\n",
       "      <th>confirmed</th>\n",
       "      <th>doubling_rate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>43</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>308</th>\n",
       "      <td>308</td>\n",
       "      <td>2020-01-23</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>575</th>\n",
       "      <td>575</td>\n",
       "      <td>2020-01-24</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>841</th>\n",
       "      <td>841</td>\n",
       "      <td>2020-01-25</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1107</th>\n",
       "      <td>1107</td>\n",
       "      <td>2020-01-26</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1373</th>\n",
       "      <td>1373</td>\n",
       "      <td>2020-01-27</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-0.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1638</th>\n",
       "      <td>1638</td>\n",
       "      <td>2020-01-28</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>4.0</td>\n",
       "      <td>-0.166667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1905</th>\n",
       "      <td>1905</td>\n",
       "      <td>2020-01-29</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2171</th>\n",
       "      <td>2171</td>\n",
       "      <td>2020-01-30</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>4.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2435</th>\n",
       "      <td>2435</td>\n",
       "      <td>2020-01-31</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>5.0</td>\n",
       "      <td>7.666667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2702</th>\n",
       "      <td>2702</td>\n",
       "      <td>2020-02-01</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>8.0</td>\n",
       "      <td>1.833333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2968</th>\n",
       "      <td>2968</td>\n",
       "      <td>2020-02-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.066667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3233</th>\n",
       "      <td>3233</td>\n",
       "      <td>2020-02-03</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>12.0</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3501</th>\n",
       "      <td>3501</td>\n",
       "      <td>2020-02-04</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>12.0</td>\n",
       "      <td>10.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3766</th>\n",
       "      <td>3766</td>\n",
       "      <td>2020-02-05</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>12.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4034</th>\n",
       "      <td>4034</td>\n",
       "      <td>2020-02-06</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>12.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4299</th>\n",
       "      <td>4299</td>\n",
       "      <td>2020-02-07</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>13.0</td>\n",
       "      <td>23.666667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4564</th>\n",
       "      <td>4564</td>\n",
       "      <td>2020-02-08</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>13.0</td>\n",
       "      <td>24.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4831</th>\n",
       "      <td>4831</td>\n",
       "      <td>2020-02-09</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>14.0</td>\n",
       "      <td>25.666667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5096</th>\n",
       "      <td>5096</td>\n",
       "      <td>2020-02-10</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>14.0</td>\n",
       "      <td>26.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5363</th>\n",
       "      <td>5363</td>\n",
       "      <td>2020-02-11</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>13.666667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5629</th>\n",
       "      <td>5629</td>\n",
       "      <td>2020-02-12</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>14.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5894</th>\n",
       "      <td>5894</td>\n",
       "      <td>2020-02-13</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6161</th>\n",
       "      <td>6161</td>\n",
       "      <td>2020-02-14</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6427</th>\n",
       "      <td>6427</td>\n",
       "      <td>2020-02-15</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6693</th>\n",
       "      <td>6693</td>\n",
       "      <td>2020-02-16</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6959</th>\n",
       "      <td>6959</td>\n",
       "      <td>2020-02-17</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7224</th>\n",
       "      <td>7224</td>\n",
       "      <td>2020-02-18</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7491</th>\n",
       "      <td>7491</td>\n",
       "      <td>2020-02-19</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7758</th>\n",
       "      <td>7758</td>\n",
       "      <td>2020-02-20</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>16.0</td>\n",
       "      <td>inf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51913</th>\n",
       "      <td>51913</td>\n",
       "      <td>2020-08-04</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>212828.0</td>\n",
       "      <td>262.747512</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52179</th>\n",
       "      <td>52179</td>\n",
       "      <td>2020-08-05</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>214113.0</td>\n",
       "      <td>211.804529</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52444</th>\n",
       "      <td>52444</td>\n",
       "      <td>2020-08-06</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>215039.0</td>\n",
       "      <td>192.571536</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52711</th>\n",
       "      <td>52711</td>\n",
       "      <td>2020-08-07</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>216196.0</td>\n",
       "      <td>205.544407</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52977</th>\n",
       "      <td>52977</td>\n",
       "      <td>2020-08-08</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>216903.0</td>\n",
       "      <td>230.809013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53243</th>\n",
       "      <td>53243</td>\n",
       "      <td>2020-08-09</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>217288.0</td>\n",
       "      <td>396.061661</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53509</th>\n",
       "      <td>53509</td>\n",
       "      <td>2020-08-10</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>218508.0</td>\n",
       "      <td>270.110696</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53774</th>\n",
       "      <td>53774</td>\n",
       "      <td>2020-08-11</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>219540.0</td>\n",
       "      <td>193.001184</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54041</th>\n",
       "      <td>54041</td>\n",
       "      <td>2020-08-12</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>220859.0</td>\n",
       "      <td>185.844463</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54306</th>\n",
       "      <td>54306</td>\n",
       "      <td>2020-08-13</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>222281.0</td>\n",
       "      <td>160.177186</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54573</th>\n",
       "      <td>54573</td>\n",
       "      <td>2020-08-14</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>223791.0</td>\n",
       "      <td>150.644156</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54839</th>\n",
       "      <td>54839</td>\n",
       "      <td>2020-08-15</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>224488.0</td>\n",
       "      <td>201.555505</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55105</th>\n",
       "      <td>55105</td>\n",
       "      <td>2020-08-16</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>225007.0</td>\n",
       "      <td>368.126096</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55371</th>\n",
       "      <td>55371</td>\n",
       "      <td>2020-08-17</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>226700.0</td>\n",
       "      <td>202.795961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55637</th>\n",
       "      <td>55637</td>\n",
       "      <td>2020-08-18</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>228120.0</td>\n",
       "      <td>144.588821</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55903</th>\n",
       "      <td>55903</td>\n",
       "      <td>2020-08-19</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>229706.0</td>\n",
       "      <td>150.813262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56168</th>\n",
       "      <td>56168</td>\n",
       "      <td>2020-08-20</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>231292.0</td>\n",
       "      <td>143.833544</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56435</th>\n",
       "      <td>56435</td>\n",
       "      <td>2020-08-21</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>233029.0</td>\n",
       "      <td>138.237035</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56701</th>\n",
       "      <td>56701</td>\n",
       "      <td>2020-08-22</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>233861.0</td>\n",
       "      <td>180.181264</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56967</th>\n",
       "      <td>56967</td>\n",
       "      <td>2020-08-23</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>234494.0</td>\n",
       "      <td>318.173606</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57233</th>\n",
       "      <td>57233</td>\n",
       "      <td>2020-08-24</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>236122.0</td>\n",
       "      <td>206.718414</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57499</th>\n",
       "      <td>57499</td>\n",
       "      <td>2020-08-25</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>237583.0</td>\n",
       "      <td>151.843207</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57765</th>\n",
       "      <td>57765</td>\n",
       "      <td>2020-08-26</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>239010.0</td>\n",
       "      <td>163.523315</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58030</th>\n",
       "      <td>58030</td>\n",
       "      <td>2020-08-27</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>240571.0</td>\n",
       "      <td>159.009817</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58297</th>\n",
       "      <td>58297</td>\n",
       "      <td>2020-08-28</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>242126.0</td>\n",
       "      <td>153.408858</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58561</th>\n",
       "      <td>58561</td>\n",
       "      <td>2020-08-29</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>242835.0</td>\n",
       "      <td>212.643110</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58829</th>\n",
       "      <td>58829</td>\n",
       "      <td>2020-08-30</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>243305.0</td>\n",
       "      <td>410.798699</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59093</th>\n",
       "      <td>59093</td>\n",
       "      <td>2020-08-31</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>244802.0</td>\n",
       "      <td>246.734960</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59361</th>\n",
       "      <td>59361</td>\n",
       "      <td>2020-09-01</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>246015.0</td>\n",
       "      <td>179.595818</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59626</th>\n",
       "      <td>59626</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>no</td>\n",
       "      <td>Germany</td>\n",
       "      <td>247411.0</td>\n",
       "      <td>187.636259</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>225 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       index       date state  country  confirmed  doubling_rate\n",
       "43        43 2020-01-22    no  Germany        0.0            NaN\n",
       "308      308 2020-01-23    no  Germany        0.0            NaN\n",
       "575      575 2020-01-24    no  Germany        0.0            NaN\n",
       "841      841 2020-01-25    no  Germany        0.0            NaN\n",
       "1107    1107 2020-01-26    no  Germany        0.0            NaN\n",
       "1373    1373 2020-01-27    no  Germany        1.0      -0.333333\n",
       "1638    1638 2020-01-28    no  Germany        4.0      -0.166667\n",
       "1905    1905 2020-01-29    no  Germany        4.0       1.000000\n",
       "2171    2171 2020-01-30    no  Germany        4.0            inf\n",
       "2435    2435 2020-01-31    no  Germany        5.0       7.666667\n",
       "2702    2702 2020-02-01    no  Germany        8.0       1.833333\n",
       "2968    2968 2020-02-02    no  Germany       10.0       2.066667\n",
       "3233    3233 2020-02-03    no  Germany       12.0       4.000000\n",
       "3501    3501 2020-02-04    no  Germany       12.0      10.333333\n",
       "3766    3766 2020-02-05    no  Germany       12.0            inf\n",
       "4034    4034 2020-02-06    no  Germany       12.0            inf\n",
       "4299    4299 2020-02-07    no  Germany       13.0      23.666667\n",
       "4564    4564 2020-02-08    no  Germany       13.0      24.333333\n",
       "4831    4831 2020-02-09    no  Germany       14.0      25.666667\n",
       "5096    5096 2020-02-10    no  Germany       14.0      26.333333\n",
       "5363    5363 2020-02-11    no  Germany       16.0      13.666667\n",
       "5629    5629 2020-02-12    no  Germany       16.0      14.333333\n",
       "5894    5894 2020-02-13    no  Germany       16.0            inf\n",
       "6161    6161 2020-02-14    no  Germany       16.0            inf\n",
       "6427    6427 2020-02-15    no  Germany       16.0            inf\n",
       "6693    6693 2020-02-16    no  Germany       16.0            inf\n",
       "6959    6959 2020-02-17    no  Germany       16.0            inf\n",
       "7224    7224 2020-02-18    no  Germany       16.0            inf\n",
       "7491    7491 2020-02-19    no  Germany       16.0            inf\n",
       "7758    7758 2020-02-20    no  Germany       16.0            inf\n",
       "...      ...        ...   ...      ...        ...            ...\n",
       "51913  51913 2020-08-04    no  Germany   212828.0     262.747512\n",
       "52179  52179 2020-08-05    no  Germany   214113.0     211.804529\n",
       "52444  52444 2020-08-06    no  Germany   215039.0     192.571536\n",
       "52711  52711 2020-08-07    no  Germany   216196.0     205.544407\n",
       "52977  52977 2020-08-08    no  Germany   216903.0     230.809013\n",
       "53243  53243 2020-08-09    no  Germany   217288.0     396.061661\n",
       "53509  53509 2020-08-10    no  Germany   218508.0     270.110696\n",
       "53774  53774 2020-08-11    no  Germany   219540.0     193.001184\n",
       "54041  54041 2020-08-12    no  Germany   220859.0     185.844463\n",
       "54306  54306 2020-08-13    no  Germany   222281.0     160.177186\n",
       "54573  54573 2020-08-14    no  Germany   223791.0     150.644156\n",
       "54839  54839 2020-08-15    no  Germany   224488.0     201.555505\n",
       "55105  55105 2020-08-16    no  Germany   225007.0     368.126096\n",
       "55371  55371 2020-08-17    no  Germany   226700.0     202.795961\n",
       "55637  55637 2020-08-18    no  Germany   228120.0     144.588821\n",
       "55903  55903 2020-08-19    no  Germany   229706.0     150.813262\n",
       "56168  56168 2020-08-20    no  Germany   231292.0     143.833544\n",
       "56435  56435 2020-08-21    no  Germany   233029.0     138.237035\n",
       "56701  56701 2020-08-22    no  Germany   233861.0     180.181264\n",
       "56967  56967 2020-08-23    no  Germany   234494.0     318.173606\n",
       "57233  57233 2020-08-24    no  Germany   236122.0     206.718414\n",
       "57499  57499 2020-08-25    no  Germany   237583.0     151.843207\n",
       "57765  57765 2020-08-26    no  Germany   239010.0     163.523315\n",
       "58030  58030 2020-08-27    no  Germany   240571.0     159.009817\n",
       "58297  58297 2020-08-28    no  Germany   242126.0     153.408858\n",
       "58561  58561 2020-08-29    no  Germany   242835.0     212.643110\n",
       "58829  58829 2020-08-30    no  Germany   243305.0     410.798699\n",
       "59093  59093 2020-08-31    no  Germany   244802.0     246.734960\n",
       "59361  59361 2020-09-01    no  Germany   246015.0     179.595818\n",
       "59626  59626 2020-09-02    no  Germany   247411.0     187.636259\n",
       "\n",
       "[225 rows x 6 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_result_larg[pd_result_larg['country']=='Germany']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
